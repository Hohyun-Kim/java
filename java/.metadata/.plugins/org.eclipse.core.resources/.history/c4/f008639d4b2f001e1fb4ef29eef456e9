package com.ssafy.trip.model.dao;

import java.util.LinkedList;
import java.util.List;
import com.ssafy.trip.model.dto.TripDto;
import com.ssafy.trip.model.dto.TripSearchDto;
import com.ssafy.trip.util.TouristDestination;
import com.ssafy.trip.util.TouristDestinationJsonParser;

public class TripDaoImpl implements TripDao {

  private List<TripDto> tripInfo;

  public TripDaoImpl() {
    loadData();
  }

  /**
   * 관광지 정보를 xml 파일에서 읽어온다.
   */
  @Override
  public void loadData() {
    // TouristDestination parser = new TouristDestinationSAXParser();
    TouristDestination parser = TouristDestinationJsonParser.getInstance();
    tripInfo = parser.getTripInfo();
  }

  @Override
  public List<TripDto> searchAll(TripSearchDto tripSearchDto) {
    List<TripDto> finds = new LinkedList<TripDto>();

    String touristDestination = tripSearchDto.getTouristDestination(); // 관광지
    String sido = tripSearchDto.getSido(); // 주소
    if (touristDestination != null) {
      for (TripDto trip : tripInfo) {
        if (trip.getTitle().contains(touristDestination)) {
          finds.add(trip);
        }
      }
    } else if (sido != null) {
      for (TripDto trip : tripInfo) {
        if (trip.getAddr1().contains(sido)) {
          finds.add(trip);
        }
      }
    } else {
      finds = tripInfo;
    }
    return finds;
  }

  @Override
  public TripDto search(int num) {
    TripDto result = null;

    for (TripDto trip : tripInfo) {
      if (trip.getContentid() == num) {
        result = trip;
        break;
      }
    }

    return result;
  }

  public static void print(List<TripDto> trips) {
    for (TripDto trip : trips) {
      System.out.println(trip);
    }

    System.out.println();
  }
}
